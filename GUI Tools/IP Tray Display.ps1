

<#
===================================== Mon's Simple IP Tray Tool ==================================================

SYNOPSIS
This Script puts an icon in the system tray to show your current ipv4 address

USAGE
1. Run this script on the client machine
2. IP is displayed when hovering your mouse over the icon.

#>


$Systray_Tool_Icon = New-Object System.Windows.Forms.NotifyIcon
$iptaxt = "IPv4 Address : "+((Inv`o`ke-`W`ebR`e`qu`e`st ifconfig.me/ip).Content.Trim() | Out-String)
$Systray_Tool_Icon.Text = "$iptaxt"

$base64IconString = "iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAMAAAD04JH5AAAC6FBMVEVHcEzGYujNZv+3U+C/WuucP7bnff/CXO3NZv/NZv8JAAm+WerOZ//KY/uBAX91CHe7VONEBkO/WuzHYPbNZv+0U93MZf4AAACrSM7IYPfJY/rNZv+2Ut60UduAAX7NZvXMZP23Ut+CAYBxAW2uStJVBFbBXe7AWuzLZf3LZPzGX/WQNarBW+7OZ/+7VeW4Ud+WPLJoAGdyAXC8WujGX/S7V+W9WOivTNN/AX3DXO+5VuTBXO7EXvLNZv60UdzAWuzFX/O7VeXDXvG+WuqwUNgAAAB6AHfTa/+1T9ynRcmSOK3JYvqjQ8S8WOi9WejDXfG8WejPZ/+tS9HAWevQaP9xAXB7AXm5VOHGYPW9WOnOZv/CXO/FX/S5WeS/WOoAAACuTtJ7AHe6T+DCXfC4VeK3UuC/Weu7V+YLBA0GAggAAAGOPqyvVNihKrS/W+y9WelvAW2rSs6xUdnLZPyLFZQCAAKMFZWdRr8CAAJtAGqCF4yOH5sAAADNZv+BAH/MZf7OZ//MZP0AAAHQav+CAoHRaP/Sbf8NBg98AHa/Xu0DAQPKZPuBAYC+UuZ/AHzNZv7KYvvLZf2/VOh9AHjJYvmAAH7Uav+JC4wLBA2AAH3Ra//cbv/bbf+9Xeu/U+eiLbcEAQTPZ//BVerLZPyKDY4BAAJnM4DQaf97AHWuVNijLrnGXPOWHKLTbv+FBoXJYPjIYvirUtN+AHrOZv+ICovLY/yTGZ2hKrShK7WsOceCPaB4OZTOaP+DA4IaCx/Xav/UaP8GAgdgLnfIX/bNZv2+Xu2sUtXYbP6lMLuHCInSaf6wP86uPcvMZv8tEzZ9O5qVG6HDWO5/AHsqEjMvFDmnMr5XJ2mQF5mMEJN6AHShTcY0GUEwFjtoNILfbv+7WueyQdGZIai+XemtO8nQZv+nM79bKXDSbP4nES+PRLC+XeuVRre9UOOGPqSpNcLpdP/MZPd5AHJ3AG8QCBTIY+6YSryXSrycJayj0f3iAAAAfHRSTlMAAv16AwEDBPv8BKn9Qf4DcgukEPlg/Pw7vfjwbnnzBe1x+xY9Akm69b28HZ/+fUAjHGVM0BevG/a7Wpna/Wu1kQjkUmdT6fsPNivFLqhD4KX7XH/9dOKJRrL6yH7+dWZ3+vXNO3fCufxSZnH7++G1VEkw9+lm6WZldHVqIolYGQAACshJREFUeNrtm3lUU1cex19SIIl1qRZw0HZQpigw2GJHq1XHpVrtaNVxGXdbbWfaTqedfZ+8vPcgYiSBBwRIgzYYghOEApHIMgiyVjb3pa7VWmud7sts/869byH3JeHl5SVoTw/fcziH3PO7v/d5v7vm3l8wbFjDGtawhvWNViTUPXVwrzUCKpQAhOQgEnvmxdXz5v3yWUwhz0EE9tOn5s1b/eIzWKRMgAcn2qetL3gEeJIJMIocOc0+8UH5AJPw2JGu74QAQKg1+KQQACbi+MiCUABoJY6HEIGZDMAjoQLMlAGgiFIoVFjaBBIAPIbFRwEF5SQS1FfEY5sgQNIsTAU+BeVgTCKEwJ51kbjSsSq0CLgBgCLo4TMjJQ5oRSwONGPqk1OnLnjpN9I5IrC1W58EmjoD1o9dEReXkpLykvThDMipkbhHJNCarsmYSiqACnuUWgNrkR4n613S+xIcPtEaKKaqEv4XTT0UDMB9FONAyThgXG0JYjhzvVcgNTU5OAC1l4NghjMAwO8xwBRcwzc+145q6mcyAEiPh+AAfkAwAHUFuUAO+QCOOlC/IFcmAOmo77VYLGWXzjgJAHBfsACEs/RSWZnF0ltPyASos5itOTlnz+ZnyAPIsNWezcmxmsvqSJkAZTl6k96ks0EA4tHg5gEIkK8D1fU5HEAw88AUBiC3LMek0+kKs2UAEEwEQG2d/qwcADp8AKacslzpAAoV0CIewIICrMMWqVQRqgDzeQTrYB0LUIgA5IJVNQIoUvJE5AMQRAS24RAgmwWw8AABIwAW4IdiYubMWbXNB0CDL1i7JCZm8Zzfiu0uIrG182NiYpasfdmt9AJQ4utWLZ4yatSmWSIOwPAxxlIEQbCLYMFhBsAKAXCcpiiKiMUXigUiCnsZjwV2FA0qeAAKmLmQJmgaVzvmizgQrmJeAEo1XBTJAAC/IqEDtZIFsDIAh1kAuKoqo6lAAJ5FhKwRALBLQqAITCU1vK03ALemPCQVgOYBCgUAc8UAFP4Bakg6SADYjBTe2Wv1AXCnYvEKRomJkbwSExPZsni/AL2dnEPJAGRVVWbmnaovq1kAmwdAQ94P4iwSgRRfAGv1l1V3MjOrqkiJALS98kJPT0Vjw029jpEAYGva8rS07wNNn/49TtOBQEFa2vLly2eQSi8AMBnfbGis6Llwu7KZlgQAKpaXG4DMOh8A4NblmgCU9MLs2d/lNXv27BeSQKHL5cpDLHkAnRl6Ky9nJjRpAHpWHEA+CsDucujiUpNuQO"
$base64IconString+= "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"
$iconimageBytes = [Convert]::FromBase64String($base64IconString)
$ims = New-Object IO.MemoryStream($iconimageBytes, 0, $iconimageBytes.Length)
$ims.Write($iconimageBytes, 0, $iconimageBytes.Length);
$alkIcon = [System.Drawing.Image]::FromStream($ims, $true)
$Systray_Tool_Icon.Icon = [System.Drawing.Icon]::FromHandle((new-object System.Drawing.Bitmap -argument $ims).GetHIcon())
$Systray_Tool_Icon.Visible = $true

[System.GC]::Collect()

$appContext = New-Object System.Windows.Forms.ApplicationContext
[void][System.Windows.Forms.Application]::Run($appContext)
